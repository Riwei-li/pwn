# 722日志
[toc]
## RSA算法
### 什么是RSA
RSA算法是现今使用最广泛的公钥密码算法，也是号称地球上最安全的加密算法。在了解RSA算法之前，先熟悉下几个术语
根据密钥的使用方法，可以将密码分为对称密码和公钥密码
对称密码：加密和解密使用同一种密钥的方式
公钥密码：加密和解密使用不同的密码的方式，因此公钥密码通常也称为非对称密码。

### RSA加密流程

#### 公钥和私钥的生成
 RSA生成公钥与私钥
1. 选择两个不同的质数p和q，并计算它们的乘积n。
2. 计算n的欧拉函数φ(n) = (p-1)(q-1)。
3. 选择一个整数e，使得1 < e < φ(n)，且e与φ(n)互质。这将成为公钥的一部分。
4. 计算e的模反元素d，使得ed ≡ 1 (mod φ(n))。这将成为私钥的一部分。
5. 公钥为(n, e)，私钥为(n, d)。
6. 加密：将明文m转换为整数M，然后使用公式 C ≡ M^e (mod n) 将其加密为密文C。
7. 解密：使用私钥的d值，通过公式 M ≡ C^d (mod n) 将密文C解密为明文M。

RSA算法的安全性基于大整数分解的困难性。如果能够有效地分解n并找到p和q，那么就可以破解RSA加密。
```
eg:
1. 选择两个不同的质数p和q：

- 假设 p = 11
- 假设 q = 17
2. 计算n的值：

- n = p * q = 11 * 17 = 187
3. 计算φ(n)的值：

- φ(n) = (p-1) * (q-1) = (11-1) * (17-1) = 160
4. 选择一个整数e：

 假设 e = 7 （满足 1 < e < φ(n) 且 e与φ(n)互质）
5. 计算e的模反元素d：

- 使用扩展欧几里得算法或其他方法计算出 d 的值，使得 (d * e) mod φ(n) = 1
- 假设 d = 23
最终，我们得到以下相关值：

- p = 11
- q = 17
- n = 187
- φ(n) = 160
- e = 7
- d = 23
这些值之间的关系是：

- n = p * q
- φ(n) = (p-1) * (q-1)
- (e * d) mod φ(n) = 1
```

#### 加解密过程

基于前面提到的RSA示例，我们假设你已经有了以下相关值：

- p = 11
- q = 17
- n = 187
- φ(n) = 160
- e = 7
- d = 23

下面是对明文254的加密和解密过程：

1. 加密：

- 将明文 M = 254 转换为整数。
2. 使用公钥加密：

- 密文 C = (M^e^) mod n
    - C = (254^7^) mod 187
    - C ≈ 129
3. 解密：

4. 使用私钥解密：
- 明文 M = (C^d^) mod n
    - M = (129^23^) mod 187
    - M = 254
通过上述步骤，我们可以看到明文254经过加密和解密后仍然是254，说明RSA算法的正确性。

以下是相关的关系式子：

- 加密：C = (M^e^) mod n
- 解密：M = (C^d^) mod n
其中，M表示明文，C表示密文，e表示公钥指数，d表示私钥指数，n表示模数。加密和解密都需要使用相同的公共模数n，但使用不同的指数（e和d）来实现加密和解密操作。

>在RSA加密算法中，公钥和私钥是一对密钥，用于加密和解密数据。
1. 公钥：
- 公钥是一个包含两个部分的数对，通常表示为 (n, e)。
- n 是模数（modulus），它是两个大素数 p 和 q 的乘积：n = p * q。
- e 是指数（exponent），它是与 φ(n) 互质且小于 φ(n) 的正整数。e 用于加密明文以生成密文。
2. 私钥：

- 私钥也是一个包含两个部分的数对，通常表示为 (n, d)。
- n 同样是模数，与公钥的 n 值相同。
- d 是私钥指数（private exponent），它是通过计算得到的，满足 (d * e) mod φ(n) = 1。d 用于解密密文以恢复明文。

公钥可以安全地共享给其他人，用于加密数据。而私钥必须保持秘密，并且只能由密钥的所有者用于解密密文。

### 代码实现rsa的加密解密
首先，你需要安装```pycryptodome```模块，它是一个Python密码库，提供了RSA加密解密的函数。
```python

from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP

# 生成RSA密钥对
key = RSA.generate(2048)

# 获取公钥和私钥
public_key = key.publickey()
private_key = key.export_key()

# 明文
message = b"Hello, World!"

# 使用公钥进行加密
cipher = PKCS1_OAEP.new(public_key)
encrypted_message = cipher.encrypt(message)

print("Encrypted message:", encrypted_message)

# 使用私钥进行解密
cipher = PKCS1_OAEP.new(key)
decrypted_message = cipher.decrypt(encrypted_message)

print("Decrypted message:", decrypted_message)
```
在这个示例中，我们使用```pycryptodome```模块的```RSA```和```PKCS1_OAEP```类来执行RSA加密和解密操作。首先，我们生成了一个2048位的```RSA```密钥对，然后获取了公钥和私钥。接着，我们定义了一个明文消息，使用公钥进行加密，并使用私钥进行解密。最后，打印出加密和解密后的结果。
